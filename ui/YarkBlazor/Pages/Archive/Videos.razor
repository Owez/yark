@page "/archive/videos"
@inject Blazored.SessionStorage.ISyncSessionStorageService SessionStorage
@using YarkApiClient

<h1 class="dashboard-title">@ArchiveName's videos</h1>
@if (Archive != null && ArchiveName != null)
{
    <YarkBlazor.Components.VideoList ArchiveId=@Archive.Meta.Id Videos=@Archive.Videos.Data />
}

@* TODO: move to layout and then only slight tweaks for videos/livestreams/shorts *@

@code {
    [Parameter]
    [SupplyParameterFromQuery(Name = "page")]
    public int Page { get; set; } = 0;

    string? ArchiveName { get; set; }

    Archive? Archive { get; set; }

    protected override async Task OnInitializedAsync()
    {
        ArchiveName = SessionStorage.GetItem<string>("OpenedArchiveName");

        Archive archive = SessionStorage.GetItem<Archive>("OpenedArchive");
        await archive.PullVideos(VideoCollectionKind.Videos, Page);
        Archive = archive;

        await base.OnInitializedAsync();
    }
}